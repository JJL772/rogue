<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python File Reader &mdash; Rogue v5.13.0-110-g718b7a89-dirty documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="File Operation Classes" href="classes/index.html" />
    <link rel="prev" title="Custom Writers" href="custom.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Rogue
          </a>
              <div class="version">
                v5.13.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installing/index.html">Installing &amp; Compiling Rogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfaces/index.html">Interfaces</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Utilities</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">File I/O Utilities</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="writing.html">Writing Frames To A File</a></li>
<li class="toctree-l3"><a class="reference internal" href="reading.html">Reading Frames From A File</a></li>
<li class="toctree-l3"><a class="reference internal" href="custom.html">Custom Writers</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Python File Reader</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#filereader-description">FileReader Description</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="classes/index.html">File Operation Classes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../prbs/index.html">PRBS Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../compression/index.html">Compression Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/index.html">Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../protocols/index.html">Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../logging/index.html">Logging In Rogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../custom_module/index.html">Creating Custom Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pydm/index.html">Using the PyDM Gui</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Rogue</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Utilities</a> &raquo;</li>
          <li><a href="index.html">File I/O Utilities</a> &raquo;</li>
      <li>Python File Reader</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/utilities/fileio/python_reader.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-file-reader">
<span id="utilities-fileio-python-reader"></span><h1>Python File Reader<a class="headerlink" href="#python-file-reader" title="Permalink to this headline"></a></h1>
<p>The Rogue FileReader class is a lightweight python class which can be used on its own
with minimal dependencies. The file reader supports processing store data frame by
frame and supports automatic extraction of configuration and status information which may
exist in a specificed “config channel”. The passed file parameter can be a single file or
a list of segemented data files.</p>
<p>The most current file can be downloaded from:</p>
<p><a class="reference external" href="https://github.com/slaclab/rogue/blob/master/python/pyrogue/utilities/fileio/_FileReader.py">https://github.com/slaclab/rogue/blob/master/python/pyrogue/utilities/fileio/_FileReader.py</a></p>
<p>Below is an example of using the FileReader in a python script:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">FileReader</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="s2">&quot;mydata.dat&quot;</span><span class="p">,</span><span class="n">configChan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>

   <span class="c1"># Loop through the file data</span>
   <span class="k">for</span> <span class="n">header</span><span class="p">,</span><span class="n">data</span> <span class="ow">in</span> <span class="n">fd</span><span class="o">.</span><span class="n">records</span><span class="p">():</span>

      <span class="c1"># Look at record header data</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing record. Total=</span><span class="si">{</span><span class="n">fd</span><span class="o">.</span><span class="n">totCount</span><span class="si">}</span><span class="s2">, Current=</span><span class="si">{</span><span class="n">fd</span><span class="o">.</span><span class="n">currCount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Record size    = </span><span class="si">{</span><span class="n">header</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Record channel = </span><span class="si">{</span><span class="n">header</span><span class="o">.</span><span class="n">channel</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Record flags   = </span><span class="si">{</span><span class="n">header</span><span class="o">.</span><span class="n">flags</span><span class="si">:</span><span class="s2">#x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Record error   = </span><span class="si">{</span><span class="n">header</span><span class="o">.</span><span class="n">error</span><span class="si">:</span><span class="s2">#x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

      <span class="c1"># Do something with the data here:</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
         <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Byte </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">#x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

      <span class="c1"># At any time you can access the current config and status state</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data time = </span><span class="si">{</span><span class="n">fd</span><span class="o">.</span><span class="n">configValue</span><span class="p">[</span><span class="s1">&#39;root.Time&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In some cases the data file contains frames that are “batched” using the BatcherV1 protocol:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">FileReader</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="s2">&quot;mydata.dat&quot;</span><span class="p">,</span><span class="n">configChan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>

   <span class="c1"># Loop through the file data</span>
   <span class="k">for</span> <span class="n">header</span><span class="p">,</span><span class="n">bHeader</span><span class="p">,</span><span class="n">data</span> <span class="ow">in</span> <span class="n">fd</span><span class="o">.</span><span class="n">records</span><span class="p">():</span>

      <span class="c1"># Look at record header data</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing record. Total=</span><span class="si">{</span><span class="n">fd</span><span class="o">.</span><span class="n">totCount</span><span class="si">}</span><span class="s2">, Current=</span><span class="si">{</span><span class="n">fd</span><span class="o">.</span><span class="n">currCount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Record size    = </span><span class="si">{</span><span class="n">header</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Record channel = </span><span class="si">{</span><span class="n">header</span><span class="o">.</span><span class="n">channel</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Record flags   = </span><span class="si">{</span><span class="n">header</span><span class="o">.</span><span class="n">flags</span><span class="si">:</span><span class="s2">#x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Record error   = </span><span class="si">{</span><span class="n">header</span><span class="o">.</span><span class="n">error</span><span class="si">:</span><span class="s2">#x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batcher size   = </span><span class="si">{</span><span class="n">bHeader</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batcher tdest  = </span><span class="si">{</span><span class="n">bHeader</span><span class="o">.</span><span class="n">tdest</span><span class="si">:</span><span class="s2">#x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batcher fUser  = </span><span class="si">{</span><span class="n">bHeader</span><span class="o">.</span><span class="n">fUser</span><span class="si">:</span><span class="s2">#x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batcher lUser  = </span><span class="si">{</span><span class="n">bHeader</span><span class="o">.</span><span class="n">lUser</span><span class="si">:</span><span class="s2">#x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

      <span class="c1"># Do something with the data here:</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
         <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Byte </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">#x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

      <span class="c1"># At any time you can access the current config and status state</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data time = </span><span class="si">{</span><span class="n">fd</span><span class="o">.</span><span class="n">configValue</span><span class="p">[</span><span class="s1">&#39;root.Time&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<section id="filereader-description">
<h2>FileReader Description<a class="headerlink" href="#filereader-description" title="Permalink to this headline"></a></h2>
<p>The class description for the SimpleClient class is included below:</p>
<p>The header data record is described below:</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="custom.html" class="btn btn-neutral float-left" title="Custom Writers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="classes/index.html" class="btn btn-neutral float-right" title="File Operation Classes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, SLAC National Accelerator Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>